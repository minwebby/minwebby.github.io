var SplashColor=function(){function l(a,b,e,d){this.width=a;this.height=b;this.size=a*b*4;this.data=new Float32Array(this.size);for(var c=0;c<this.size;++c)this.data[c]=0;this.texture=new THREE.DataTexture(this.data,a,b,THREE.RGBAFormat,THREE.FloatType);this.texture.minFilter=THREE.NearestFilter;this.texture.magFilter=THREE.NearestFilter;this.texture.needsUpdate=!0;this.splashCount=0;this.splashCycle=e;this.splatRadius=d}function m(a){var b=a.parentNode;this.scene=new THREE.Scene;this.camera=new THREE.OrthographicCamera(a.width/
-2,a.width/2,a.height/2,a.height/-2,0,1E3);this.camera.position.z=0;this.renderer=new THREE.WebGLRenderer;a=a.height*n.innerWidth()/a.width;this.renderer.setSize(n.innerWidth(),a);b.appendChild(this.renderer.domElement);this.uniforms={};this.splashMask=null}function p(a,b){this.functions=a?a:[];this.clock=new THREE.Clock(!0);this.cv=b}function f(){this.targetImg=null;this.forever=!1;this.toTime=this.fromTime=0;this.animFrame=this.glCanvas=null}var g=null,n=null,k={};l.prototype.reset=function(){for(var a=
0;a<this.size;++a)this.data[a]=0;for(a=3;a<this.size;a+=4)this.data[a]=1;this.splashCount=0;this.texture.needsUpdate=!0};l.prototype.splash2=function(){if(this.splashCount>this.splashCycle)this.reset();else{++this.splashCount;var a=Math.floor(Math.random()*this.width),b=Math.floor(Math.random()*this.height);this.texture.needsUpdate=!0;return{x:a/this.width,y:b/this.height}}};m.prototype.drawImage=function(a,b){var e=new THREE.PlaneBufferGeometry(a.width,a.height,1,1),d=new THREE.Texture(a);d.needsUpdate=
!0;d.minFilter=THREE.NearestFilter;var c=new THREE.Texture(b);c.needsUpdate=!0;c.minFilter=THREE.NearestFilter;this.splashMask=new l(a.width,a.height,100,150);var h=new THREE.AmbientLight(16777215);this.scene.add(h);this.uniforms={texture:{type:"t",value:d},noiseTexture:{type:"t",value:c},splashMask:{type:"t",value:this.splashMask.texture},centerX:{type:"f",value:0},centerY:{type:"f",value:0}};d=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:document.getElementById("vs0").textContent,
fragmentShader:document.getElementById("fs3").textContent});e=new THREE.Mesh(e,d);e.position.x=0;e.position.y=0;e.position.z=0;this.scene.add(e);this.renderer.render(this.scene,this.camera)};m.prototype.render=function(){this.renderer.render(this.scene,this.camera)};p.prototype.start=function(){var a=this;requestAnimationFrame(function(){a.start.call(a)});for(var b=0;b<this.functions.length;++b)this.functions[b].call(null,this.cv,this.clock.getElapsedTime(),this.clock.getDelta());this.clock.running||
this.clock.start()};f.prototype.setTarget=function(a,b){this.targetImg=a;this.glCanvas=new m(a);this.glCanvas.drawImage(a,b);a.style.display="none";b.style.display="none"};f.prototype.setForever=function(){this.forever=!0};f.prototype.start=function(){var a=0,b=.1,e=.1,d=.5,c=.5;(new p([function(h,f,g){a+=100*g;if(8E-5<=a){if(h.splashMask&&(f=h.splashMask.splash2())){d+=b*Math.sin(f.x/10);c+=e*Math.sin(f.y/10);if(.9<d||.1>d)b=-b;if(.9<c||.1>c)e=-e;h.uniforms.centerX.value=d;h.uniforms.centerY.value=
c}a=0}},function(a,b,c){a.render()}],this.glCanvas)).start()};f.prototype.show=function(){$(this.glCanvas.renderer.domElement).show()};f.prototype.hide=function(){$(this.glCanvas.renderer.domElement).hide()};return{effect:f,apply:function(a,b,e){g=e;n=$(g);var d=g.appendChild(document.createElement("img"));d.addEventListener("load",function(){var c=g.appendChild(document.createElement("img"));c.addEventListener("load",function(){c.style.display="none";d.style.display="none";k.start=function(){a.setTarget(c,
d);a.setForever();g.removeChild(c);g.removeChild(d);a.start()};k.show=function(){a.show()};k.hide=function(){a.hide()}});c.style.position="absolute";c.width=375;c.height=250;c.src=b});d.src="/src/theme/img/noise.png"},mkawesome:k}}();